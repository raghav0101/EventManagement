<!DOCTYPE html>
<!--[if IE 8]>
<html xmlns="http://www.w3.org/1999/xhtml" class="ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 8) ]><!-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<!--<![endif]-->

<!-- Mirrored from demo.ovathemes.com/eventmana/wp-login.php?registration=disabled by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 26 Oct 2019 06:07:23 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>Log In &lsaquo; Event Management WordPress Theme &#8212; WordPress</title>
	<link rel='dns-prefetch' href='http://s.w.org/' />
	<link rel='stylesheet' id='dashicons-css'  href='wp-includes/css/dashicons.min4d2c.css?ver=5.2.4' type='text/css' media='all' />
	<link rel='stylesheet' id='buttons-css'  href='wp-includes/css/buttons.min4d2c.css?ver=5.2.4' type='text/css' media='all' />
	<link rel='stylesheet' id='forms-css'  href='wp-admin/css/forms.min4d2c.css?ver=5.2.4' type='text/css' media='all' />
	<link rel='stylesheet' id='izi'  href='https://cdnjs.cloudflare.com/ajax/libs/izitoast/1.4.0/css/iziToast.css' type='text/css' media='all' />
	<link rel='stylesheet' id='l10n-css'  href='wp-admin/css/l10n.min4d2c.css?ver=5.2.4' type='text/css' media='all' />
	<link rel='stylesheet' id='login-css'  href='wp-admin/css/login.min4d2c.css?ver=5.2.4' type='text/css' media='all' />
	<meta name='robots' content='noindex,noarchive' />
	<meta name='referrer' content='strict-origin-when-cross-origin' />
	<meta name="viewport" content="width=device-width" />
</head>
<body class="login login-action-login wp-core-ui  locale-en-us">
<div id="login">
	<h1>Create Event</h1>
	<!--<div id="login_error">	User registration is currently not allowed.<br />
</div>-->

	<form name="eventform" id="eventform" >
		<p>
			<label for="user_login">Event Name<br />
				<input type="text" name="log" id="user_login" aria-describedby="login_error" class="input" value="" size="20" autocapitalize="off" /></label>
		</p>
		<p>
			<label >Event Type<br />
				<select name="eventType" form="eventform" id="sel">
					<option value="Technical">Technical</option>
					<option value="Gaming">Gaming</option>
					<option value="Cultural">Cultural</option>
					<option value="Other">Other</option>
				</select></label>
		</p><br>
		<p>
				<label for="event_date">Event Date<br />
				<input type="date" name="pwd" id="event_date" aria-describedby="login_error" class="input" value="" size="20" /></label>
		</p>
		<p>
			<label for="event_time">Event Time<br />
				<input type="time" name="log" id="event_time" aria-describedby="login_error" class="input" value="" size="20" autocapitalize="off" /></label>
		</p>
		<p>
			<label >Event Venue<br />
				<select name="eventType" form="eventform" id="sel1">
					<option value="Sja-1">Sja-1</option>
					<option value="Atb-0.1">ATB-0.1</option>
					<option value="Atb-0.2">ATB-0.2</option>
					<option value="Atb-0.3">ATB-0.3</option>
					<option value="Atb-1.1">ATB-1.1</option>
					<option value="Atb-1.2">ATB-1.2</option>
					<option value="Atb-1.3">ATB-1.3</option>
					<option value="NTB-L001">NTB-L001</option>
					<option value="NTB-L002">NTB-L002</option>
					<option value="NTB-L003">NTB-L003</option>
					<option value="NTB-L101">NTB-L101</option>
					<option value="NTB-L102">NTB-L102</option>
					<option value="SAC-1">SAC-1</option>
					<option value="MB-MSH">MB-MSH</option>
				</select></label>
		</p><br>
		<p>
			<label for="event_desc">Description<br />
				<input type="text" name="log" id="event_desc" aria-describedby="login_error" class="input" value="" size="20" autocapitalize="off" /></label>
		</p>
<!--		<p>-->
<!--			<label for="user_login">Conducting Organisation Name<br />-->
<!--				<input type="text" name="log" id="orgName" aria-describedby="login_error" class="input" value="" size="20" autocapitalize="off" /></label>-->
<!--		</p>-->
<!--		<p>-->
<!--			<label for="user_login">Organisation Email<br />-->
<!--				<input type="email" name="log" id="orgEmail" aria-describedby="login_error" class="input" value="" size="20" autocapitalize="off" /></label>-->
<!--		</p>-->
<!--		<p>-->
<!--			<label for="user_login">Organisation Contact Number<br />-->
<!--				<input type="number" name="log" id="orgNumber" aria-describedby="login_error" class="input" value="" size="20" autocapitalize="off" /></label>-->
<!--		</p>-->
<!--		<p>-->
<!--			<label for="user_login">Organisation Location<br />-->
<!--				<input type="text" name="log" id="orgLocation" aria-describedby="login_error" class="input" value="" size="20" autocapitalize="off" /></label>-->
<!--		</p>-->
		<p class="submit">
			<button type="button" name="wp-submit" id="wp-submit" class="button button-primary button-large"> Create</button>
		</p>
	</form>

	<script type="text/javascript">
		function wp_attempt_focus(){
			setTimeout( function(){ try{
				d = document.getElementById('user_login');
				d.focus();
				d.select();
			} catch(e){}
			}, 200);
		}

		wp_attempt_focus();
		if(typeof wpOnload=='function')wpOnload();
	</script>

	<!--<p id="backtoblog"><a href="index.html">
		&larr; Back to Event Management WordPress Theme	</a></p>-->

</div>


<script type="text/javascript">
	var wc_product_block_data = JSON.parse( decodeURIComponent( '%7B%22min_columns%22%3A1%2C%22max_columns%22%3A6%2C%22default_columns%22%3A3%2C%22min_rows%22%3A1%2C%22max_rows%22%3A6%2C%22default_rows%22%3A1%2C%22thumbnail_size%22%3A300%2C%22placeholderImgSrc%22%3A%22http%3A%5C%2F%5C%2Fdemo.ovathemes.com%5C%2Feventmana%5C%2Fwp-content%5C%2Fuploads%5C%2Fwoocommerce-placeholder.png%22%2C%22min_height%22%3A500%2C%22default_height%22%3A500%2C%22isLargeCatalog%22%3Afalse%2C%22limitTags%22%3Afalse%2C%22hasTags%22%3Afalse%2C%22productCategories%22%3A%5B%7B%22term_id%22%3A60%2C%22name%22%3A%22Uncategorized%22%2C%22slug%22%3A%22uncategorized%22%2C%22term_group%22%3A0%2C%22term_taxonomy_id%22%3A60%2C%22taxonomy%22%3A%22product_cat%22%2C%22description%22%3A%22%22%2C%22parent%22%3A0%2C%22count%22%3A0%2C%22filter%22%3A%22raw%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fdemo.ovathemes.com%5C%2Feventmana%5C%2Fproduct-category%5C%2Funcategorized%5C%2F%22%7D%2C%7B%22term_id%22%3A28%2C%22name%22%3A%22event%22%2C%22slug%22%3A%22event%22%2C%22term_group%22%3A0%2C%22term_taxonomy_id%22%3A28%2C%22taxonomy%22%3A%22product_cat%22%2C%22description%22%3A%22%22%2C%22parent%22%3A0%2C%22count%22%3A9%2C%22filter%22%3A%22raw%22%2C%22link%22%3A%22http%3A%5C%2F%5C%2Fdemo.ovathemes.com%5C%2Feventmana%5C%2Fproduct-category%5C%2Fevent%5C%2F%22%7D%5D%2C%22homeUrl%22%3A%22http%3A%5C%2F%5C%2Fdemo.ovathemes.com%5C%2Feventmana%5C%2F%22%7D' ) );
</script>
<script>
	let baseurl = "http://localhost:8000";
	const createEvent = async (data) => {
		let options = {
			headers: {'Content-Type': 'application/json'},
			method: 'POST',
			body: JSON.stringify(data)
		};

		try {
			let response = await fetch(baseurl + '/event/newEvent/', options);
			if(response.status ===409){
				return undefined;
			}
			else if (response.status === 404){
				return 'notpermitted';
			}
			let jsonResponse = await response.json();
			console.log(jsonResponse);

			return jsonResponse;
		} catch (e) {
			console.log(e);
			return null;
		}
	};

	const createEventComplete = async () => {
		let eventName = document.getElementById("user_login").value;
		let e = document.getElementById("sel");
		let eventType = e.options[e.selectedIndex].value;
		let e1 = document.getElementById("sel1");
		let str = e1.options[e1.selectedIndex].value.split('-');
		let str1 = e1.options[e1.selectedIndex].value;
		let buildingName = str[0];
		let roomNo = str[1];
		let eventDate = document.getElementById("event_date").value;
		let desc = document.getElementById("event_desc").value;
		let time = document.getElementById("event_time").value;
		//let orgName = document.getElementById("orgName").value;
		//let email = document.getElementById("orgEmail").value;
		//let phn_no = document.getElementById("orgNumber").value;
		//let orgLocation = document.getElementById("orgLocation").value;
		let userId;
		if (localStorage.getItem("userId")===null){
			userId = localStorage.getItem("orgId");
		}
		else{
			userId = localStorage.getItem("userId");
		}
		//let userId = localStorage.getItem("userId")
		console.log(eventName + " " + eventType + " " + eventDate + " " + desc + " " + time + " " + buildingName + " " + roomNo + " " + str1 + " " + userId);

		let data = {
			eventName,
			eventType,
			eventDate,
			desc,
			time,
			buildingName,
			roomNo,
			userId,
		};

		let response = await createEvent(data);

		console.log(response);
		if(response==='notpermitted'){
			iziToast.show({
				title:"Message",
				message:"Not allowed. Ony organisations can create events",
				titleColor:'red',
				backgroundColor: 'yellow',
				onClosing: function(){
					//window.location.reload();
				}
			});
		}
		else {
			if (response) {
				iziToast.show({
					title: "Success",
					message: "Event added successfully",
					titleColor: 'red',
					backgroundColor: 'yellow',
					onClosing: function () {
						window.location.reload();
					}
				});
				//window.location.replace('http://localhost:63342/EventManagement/frontend/evms/demo.ovathemes.com/eventmana/index.html');
			} else if (response === undefined) {
				iziToast.show({
					title: "Message",
					message: "Venue Already Booked",
					titleColor: 'red',
					backgroundColor: 'yellow',
					onClosing: function () {
						//window.location.reload();
					}
				});
			}  else {
				iziToast.show({
					title: "Error",
					message: "Please retry",
					titleColor: 'red',
					backgroundColor: 'yellow',
					onClosing: function () {
						//window.location.reload();
					}
				});
			}
		}
	};
	document.getElementById("wp-submit").onclick = createEventComplete;
</script>
<div class="clear"></div>
</body>
<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/izitoast/1.4.0/js/iziToast.js'></script>

<!-- Mirrored from demo.ovathemes.com/eventmana/wp-login.php?registration=disabled by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 26 Oct 2019 06:07:28 GMT -->
</html>
	